<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <title>Tinkerthon // Ein Internet-Wecker mit Raspberry PI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/3.3.4/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/css/lity.min.css">
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
    <div class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Tinkerthon</a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                
                <li>
                    <a href="/interaktiver-benzoltisch-im-deutschen-museum-bonn">Benzoltisch</a>
                </li>
                
                <li>
                    <a href="/impressum">Impressum</a>
                </li>
                
                <li>
                    <a href="/konzept">Konzept</a>
                </li>
                
            </ul>
        </div>
    </div>
</div><!-- .navbar -->


    <div class="container">

        <div class="blog-header">
            <h1 class="blog-title">Ein Internet-Wecker mit Raspberry PI</h1>
        </div>

        <div class="teaser">
            <div class="image">
                <img class="thumbnail" src="/wp-content/uploads/2014/11/2014-11-25-08.04.14-e1416986033782-212x212.jpg">
                <h4>allgemein</h4>
            </div>
        </div>

        <span class="published">25.11.2014</span>
        <p>Letzten Freitag erwähnte Lena, dass sie gerne einen eigenen Wecker hätte. Ungefähr zur gleichen Zeit stolperte ich über den <a href="http://www.watterott.com/de/RPi-Display">2,8” LCD-Touchscreen für das Raspberry Pi</a> von Watterott. Das Display ist einfach auf die GPIO-Pins des Pi aufsteckbar und es gibt für beides sogar ein <a href="http://www.watterott.com/de/TEK-BERRY-Gehaeuse-transparent-v12-mit-Ausschnitt-fuer-RPi-Display">passendes Gehäuse</a>.</p>

<div id="attachment_960" style="width: 310px" class="wp-caption alignnone">
  <a href="/wp-content/uploads/2014/11/20110750_1.jpg" rel="lightbox[955]" title="Ein Internet-Wecker mit Raspberry PI"><img class="wp-image-960 size-medium" src="/wp-content/uploads/2014/11/20110750_1-300x216.jpg" alt="20110750_1" width="300" height="216" /></a>

  <p class="wp-caption-text">
    Raspberry Pi mit aufgestecktem Display (Bild: Watterott)
  </p>
</div>

<div id="attachment_961" style="width: 310px" class="wp-caption alignnone">
  <a href="/wp-content/uploads/2014/11/20110803.jpg" rel="lightbox[955]" title="Ein Internet-Wecker mit Raspberry PI"><img class="wp-image-961 size-medium" src="/wp-content/uploads/2014/11/20110803-300x187.jpg" alt="20110803" width="300" height="187" /></a>

  <p class="wp-caption-text">
    Passendes TEX Berry Gehäuse (Bild: Watterott)
  </p>
</div>

<p>Ich hatte lange Zeit ein ganz ähnliches Gerät, ein Chumby, als Wecker am Bett. Das Chumby war ein kleines, ARM-basierendes Gerät, ebenfalls mit einfachem Touchscreen, welches neben dem eingebauten Wecker und Internet-Radio noch flash-basierende Apps über Channel abonnieren und diese im Wechsel abspielen konnte. Eigentlich immer noch ein ganz valider Nutzungsfall, denn ich für Lena und auf Basis der Combo aus RaspberryPi und Touchscreen wieder zum Leben erwecken wollte.</p>

<p>Meine Idee war zunächst, auf Basis von PyGame und dessen Framebuffer-Unterstützung ein eigenes GUI zu programmieren. Das sollte ähnlich wie die Oberfläche des Chumby ein paar eingebaute Funktionen mitbringen: Uhr mit Weckfunktion, vielleicht ein Kalender, Steuerung eines lokalen Music Player Demons MDM für Musik und Hörspiele, vielleicht noch eine einfacher Mail- oder Chat-Client.</p>

<p>Die Basis-Installation des Displays war zunächst erfreulich einfach. Watterott bietet zu dem Display ein modifiziertes Raspbian-Image inklusive einem X11 mit Framebuffer-Unterstützung für das Display. Auch der Touchscreen funktioniert damit auf Anhieb. Lediglich die Anbindung an das heimische WLAN ist ein kleines Ratespiel und z.B. beim <a href="/2013/09/raspberry-pi-lehrt-web-programmierung/">Coder von Google</a> wesentlich eleganter gelöst. Nach ein paar Versuchen und ein bisschen Herum-Googlen hat es aber dann geklappt.</p>

<p>Für das Schreiben der Oberfläche ist PyGame leider kein sehr komfortabler GUI-Baukasten. Ich machte mich also auf die Suche nach etwas Produktiverem. Leider ist die Auswahl bei einem Anzeigegerät ohne OpenGL-Unterstützung sehr mau. Die libSDL wird noch am ehesten unterstützt. Ich habe dann auch einige Libraries probiert:</p>

<p>Für PyGame gibt es ein Beispiel einer MPD-Steuerung.</p>

<p>Daneben gibt es mit <a href="http://www.spida.net/projects/software/pympdtouchgui/index.en.html">PyMPDTouchGui</a> auch eine ausgewachsene Alternative. Das habe ich aber auf meinem Display nicht zum Laufen gebracht.</p>

<p>Eine Bibliothek für LUA (<a href="http://tekui.neoscientists.org">TekUI</a>) sah sehr vielversprechend aus. Die habe ich aber letztlich nicht ausprobiert.</p>

<p>Für das <a href="http://www.fltk.org/">FLTK-Toolkit</a> gibt es eine <a href="https://www.mail-archive.com/fltk-dev@easysw.com/msg00762.html">DirectFB-Unterstützung</a>.</p>

<p><a href="http://ilixi.org/">iliXi</a> läuft ebenfalls auf DirectFB, ebenso <a href="http://libagar.org/">http://libagar.org/</a></p>

<p>Selbst <a href="http://www.androwish.org/">Tcl/Tk</a> hätte eine Alternative sein können.</p>

<p><a href="http://harmoniccode.blogspot.de/2014/02/fun-with-javafx-on-raspberry-pi-again.html">JavaFX</a> wäre vielleicht auch eine Alternative gewesen.</p>

<p>Sehr interessant fand ich QML. Das hätte auch fast funktioniert, scheiterte am Ende aber an der fehlenden OpenGL-Unterstützung. Sollte ich noch einmal ein Kiosk-System mit dem regulären HDMI-Anschluss bauen wollen, ist das aber sicher ein atraktiver Ansatz mit wenig Overhead. Mein Vorgehen basierte dabei auf einem <a href="http://www.raspberrypi.org/forums/viewtopic.php?f=31&amp;t=26142">Posting im RaspberryPi-Forum</a> und basierte auf den Paketen</p>

<div>
  sudo apt-get install \
</div>

<div>
       libqt5declarative5 libqt5webkit5-dev \
</div>

<div>
       qmlscene \
</div>

<div>
       libqt5webkit5-qmlwebkitplugin \
</div>

<div>
       libegl1-mesa \
</div>

<div>
       qtdeclarative5-qtquick2-plugin
</div>

<div>
</div>

<div>
  Der einfache Aufruf hätte dann sein sollen:
</div>

<div>
</div>

<div>
  <div>
    QT_QPA_PLATFORM=linuxfb:fb=/dev/fb1 /usr/lib/arm-linux-gnueabihf/qt5/bin/qmlscene webkit.qml
  </div>

  <div>
  </div>

  <div>
    &#8230; bricht aber leider wegen mangelnder OpenGL-Unterstützung ab.
  </div>

  <div>
  </div>

  <div>
    Letztlich läuft der RaspberryPi jetzt mit einem normalen X11 mit Chromium-Browser im Kiosk Mode. Die Anleitung dafür liefert <a href="https://www.danpurdy.co.uk/web-development/raspberry-pi-kiosk-screen-tutorial/">Dan Purdy</a>.  Den Startschirm bildet eine HTML-Seite mit <a href="http://randomibis.com/coolclock/demos/demo2.html">CoolClock</a>. Es sollen weitere Seiten mit Weckeinstellungen und einer einfachen Steuerung des MPD folgen. Damit hätte ich auch endlich eine bedienbare Alternative zu meinem ersten <a href="/2013/04/internet-radio-mit-raspberrypi-2-zeiligem-rgb-lcd-und-5-tasten/">Projekt mit dem Music Player Demon</a> gefunden.
  </div>

  <div>
  </div>

  <div>
    <div id="attachment_958" style="width: 310px" class="wp-caption alignnone">
      <a href="/wp-content/uploads/2014/11/2014-11-25-08.04.14-e1416986351267.jpg" rel="lightbox[955]" title="Ein Internet-Wecker mit Raspberry PI"><img class="wp-image-958 size-medium" src="/wp-content/uploads/2014/11/2014-11-25-08.04.14-e1416986033782-300x242.jpg" alt="2014-11-25 08.04.14" width="300" height="242" /></a>

      <p class="wp-caption-text">
        Die Uhr als HTML-Seite. Rechts das Menü macht noch nichts
      </p>
    </div>
  </div>
</div>

<p>Der aktuelle Stand der Software liegt bei <a href="https://bitbucket.org/olav/lenas-uhr">Bitbucket</a> und ist open source.</p>



    </div>

    <footer class="row">
    <div class="col-sm-6">
        <p>&copy; 2010 - 2015 Dr. Olav Schettler, Bonn // Tinkerthon</p>
        <p>Tinkerthon ist eine Sammlung von Projekten von und für Kinder.</p>
    </div>
    <div class="col-sm-6">
        <ul>
            <li><a href="impressum">Impressum</a></li>
            <li><a href="kontakt">Kontakt</a></li>
        </ul>
    </div>
</footer>
<script src="/js/jquery-1.11.3.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/lity.min.js"></script>

</body>
</html>
